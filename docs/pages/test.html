<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>range slider</title>
  <link rel="stylesheet" href="../../src/theme/var.css">
  <link rel="stylesheet" href="../page.css">
  <link rel="stylesheet" href="../highlight/styles/default.css">
  <link rel="stylesheet" href="../highlight/styles/vs2015.css">
  <script src="../highlight/highlight.pack.js"></script>
  <script type="module" src="../code-support.js"></script>
</head>
<body>
  <article>
    <style>
      .test {
        border: 1px solid #ccc;
        margin: 10px;
        padding: 10px;
      }
    </style>

    <div class="test">
      <h2 bl-if="cond">
        if true {text}
        <!-- <strong bl-if="cond">Strong</strong> -->
      </h2>
      <span>span</span>
      <p bl:title="title">prefix {text} suffix</p>
    </div>

    <script type="module">
      import { parseText } from '../../dist/common/templateCompiler/utils.js'
      import { compile } from '../../dist/common/templateCompiler/index.js'
      window.parseText = parseText
      window.render = compile(document.querySelector('.test'))

      const format = (arr) => {
        return arr.map(item => item.type + '.' + (item.propName ?? item.textContent)).join(';')
      }
      
      console.assert(format(parseText('{')) === 'static.{')
      console.assert(format(parseText('{}')) === 'static.{}')
      console.assert(format(parseText('}')) === 'static.}')
      console.assert(format(parseText('1{}2')) === 'static.1{}2')
      console.assert(format(parseText('1{a}2')) === 'static.1;reactive.a;static.2')
      console.assert(format(parseText('123{{}}1{}21{a}2')) === 'static.123{{}}1{}21;reactive.a;static.2')

      window.test = (cond = true) => {
        var {$el, update} = render({ title: "INIT_TITLE", text: 'INIT_TEXT', cond })
        document.querySelector('article').appendChild($el)
        const tests = document.querySelectorAll('.test')
        const $test = tests[tests.length - 1]
        const $p = $test.querySelector('p')
        console.log('\nRUN TEST:\n')
        console.log('before:', '\n  title: ' + $p.getAttribute('title'), '\n  text: ', $p.textContent)
        update({ title: "UPDATED_TITLE", text: 'UPDATED_TEXT' })
        console.log('after:', '\n  title: ' + $p.getAttribute('title'), '\n  text: ', $p.textContent)
        window.update = update
      }
      window.test()
    </script>

  </article>
</body>
</html>
