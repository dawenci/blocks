<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Popup</title>
  <link rel="stylesheet" href="../page.css">
  <link rel="stylesheet" href="../highlight/styles/default.css">
  <link rel="stylesheet" href="../highlight/styles/vs2015.css">
  <script src="../highlight/highlight.pack.js"></script>
  <script type="module" src="../code-support.js"></script>
</head>
<body>
  <article>
    <header>
      <h1>Popup</h1>
    </header>

    <section class="section" style="position:relative">
      <script type="module" src="../../components/button/index.js"></script>
      <h2>依赖引入</h2>

      <p>根据自己项目调整 src 的路径</p>

      <div data-codesource="html" data-title="依赖引入" on>
        <script type="module" src="../../components/popup/index.js"></script>
      </div>
    </section>

    <section class="section">
      <h2>默认</h2>

      <p>默认以中心点为原点，相对于 offsetParent 的中心点进行定位。</p>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:100px;border:1px solid #ccc;">
          <bl-popup class="popup-default1">
            <div style="padding:15px;">默认居中</div>
          </bl-popup>
        </div>

        <bl-button
          onclick="document.querySelector('.popup-default1').open = !document.querySelector('.popup-default1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>箭头</h2>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:150px;border:1px solid #ccc;">
          <bl-popup open origin="top-center" arrow class="popup-arrow1" anchor="[100,10]">
            <div style="height:50px;padding:15px;">
              显示箭头
            </div>
          </bl-popup>
        </div>

        <bl-button
          onclick="document.querySelector('.popup-arrow1').open = !document.querySelector('.popup-arrow1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>    

    <section class="section">
      <h2>限制焦点</h2>

      <p>限制 tab 键只会让焦点在 popup 内部移动</p>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:100px;border:1px solid #ccc;">
          <bl-popup
            capturefocus
            class="popup-capturefocus1">
            <input type="text">
            <input type="text">
          </bl-popup>
        </div>

        <bl-button
          onclick="document.querySelector('.popup-capturefocus1').open = !document.querySelector('.popup-capturefocus1').hasAttribute('open')">
          开关
        </bl-button>

        <bl-button
          onclick="document.querySelector('.popup-capturefocus1').capturefocus = !document.querySelector('.popup-capturefocus1').capturefocus">
          切换状态
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>吸附座标区域</h2>

      <p>通过 `anchor` 属性，传入需要吸附的目标位置座标点、或两个座标点框定的区域，可以让 popup 吸附在该元素的吸附点上，吸附位置根据 popup 的 `origin` 自动确定。</p>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:150px;border:1px solid #ccc;">
          <div style="width:50px;height:50px;background:#000;color:#fff;">50,50</div>

          <bl-popup class="popup-anchor1" origin="left-start" anchor="[50,50]">
            <div style="padding:15px;">座标：[50,50]</div>
          </bl-popup>
        </div>

        <bl-button onclick="document.querySelector('.popup-anchor1').open = !document.querySelector('.popup-anchor1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>渲染在 anchor 内部</h2>

      <p>通过 `inset` 属性，让 Popup 在布局区域的内测渲染。</p>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:150px;border:1px solid #ccc;">
          <div style="width:50px;height:50px;background:#000;color:#fff;">50,50</div>

          <bl-popup class="popup-anchor-inset1" origin="left-start" anchor="[0,0,50,50]" inset>
            <div style="padding:15px;">座标：[50,50]</div>
          </bl-popup>
        </div>

        <bl-button onclick="document.querySelector('.popup-anchor-inset1').open = !document.querySelector('.popup-anchor-inset1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>吸附其他元素</h2>

      <p>通过 `anchor` 属性，传入需要吸附的目标元素 selector，可以让 popup 吸附在该元素的吸附点上，吸附位置根据 popup 的 `origin` 自动确定。</p>

      <template data-codesource="html">
        <div style="width:400px;height:100px;padding:15px;border:1px solid #ccc;">
          <div class="popup-selector1-anchor" style="width:100px;height:100px;background:#000;color:#fff;">anchor</div>

          <bl-popup class="popup-selector1" arrow origin="left-start" anchor=".popup-selector1-anchor">
            <div style="padding:15px;">左上角吸附于 anchor 右侧</div>
          </bl-popup>
        </div>

        <bl-button onclick="document.querySelector('.popup-selector1').open = !document.querySelector('.popup-selector1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>插入到 body</h2>

      <p>可以使用 `append-to-body` 属性，将组件插入到 `document.body`，以确保层叠次序精确。</p>
      <p class="note">注意：如果将 popup 作为其他组件的一部分，并在 popup 里面使用 slot 的话，因为 DOM 的移动，会导致 slot 失效，popup 无法展示通过 slot 置入的内容。</p>

      <template data-codesource="html">
        <div style="position:relative;width:300px;height:100px;border:1px solid #ccc;">
          <div class="popup-append-to-body-anchor" style="width:50px;height:50px;background:#000;color:#fff;">anchor</div>

          <bl-popup
            class="popup-append-to-body"
            arrow
            append-to-body
            origin="left-start"
            anchor=".popup-append-to-body-anchor">
            <div style="padding:15px;">popup 父节点为 body</div>
          </bl-popup>
        </div>

        <bl-button onclick="document.querySelector('.popup-append-to-body').open = !document.querySelector('.popup-append-to-body').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    <section class="section">
      <h2>自动翻转</h2>

      <p>通过 `autoflip` 属性，启用自动翻转功能，在 offsetParent 不足以容纳 popup 时，尝试翻转方向显示。</p>

      <template data-codesource="html">
        <div style="position:relative;width:250px;height:180px;border:1px solid #ccc;">
          <div
            class="popup-autoflip1-anchor"
            style="position:absolute;left:150px;top:80px;width:50px;height:50px;border:1px solid #ccc;">锚点</div>
          <bl-popup autoflip arrow class="popup-autoflip1" origin="left-start" anchor=".popup-autoflip1-anchor">
            <div style="width:100px;height:100px;">往右下会溢出<br>故往左上翻转</div>
          </bl-popup>
        </div>

        <bl-button
          onclick="document.querySelector('.popup-autoflip1').open = !document.querySelector('.popup-autoflip1').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>


    <section class="section">
      <h2>dark</h2>

      <p>通过 `dark` 属性，启用暗色主题。</p>

      <template data-codesource="html">
        <div style="position:relative;width:200px;height:150px;border:1px solid #ccc;">
          <bl-popup dark open origin="top-center" arrow class="popup-dark" anchor="[100,10]">
            <div style="height:50px;padding:15px;">
              dark 主题
            </div>
          </bl-popup>
        </div>

        <bl-button
          onclick="document.querySelector('.popup-dark').open = !document.querySelector('.popup-dark').hasAttribute('open')">
          开关
        </bl-button>
      </template>
    </section>

    
    <section class="section">
      <h2>API</h2>
      待编写
      <table>
        <thead>
          <tr>
            <th>属性名</th>
            <th>类型</th>
            <th>默认值</th>
            <th>说明</th>
            <th>必须</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>anchor</td>
            <td>string | Element | (() => string | Element)</td>
            <td></td>
            <td>
              Popup 锚定的布局框，是一个矩形区域，
              Popup 吸附在该矩形的四条边中的某一条的外侧（设置 inset 后在内测），
              支持传入一个 `[x, y]` 形式的坐标像素值，这是长宽为 0 的矩形的特例，
              支持标准的 `[x1, y1, x2, y2]` 形式的两个坐标点用于左上角、 右下角，
              支持传入其他元素的 css selector，表示以该元素的布局矩形为准。
            </td>
            <td></td>
          </tr>
          <tr>
            <td>append-to-body</td>
            <td>boolean</td>
            <td>false</td>
            <td>是否将节点插入到 document.body 中（通常用于确保 z-index 不会被遮挡）。</td>
            <td></td>
          </tr>
          <tr>
            <td>arrow</td>
            <td>boolean</td>
            <td>false</td>
            <td>Popup 是否显示箭头。</td>
            <td></td>
          </tr>
          <tr>
            <td>autoflip</td>
            <td>false</td>
            <td></td>
            <td>是否启用自动翻转功能。启用后，Popup 在 x 或 y 轴上溢出文档时，自动翻转显示。</td>
            <td></td>
          </tr>
          <tr>
            <td>autofocus</td>
            <td>false</td>
            <td></td>
            <td>打开时是否自动聚焦。</td>
            <td></td>
          </tr>
          <tr>
            <td>capturefocus</td>
            <td>false</td>
            <td></td>
            <td>是否捕获焦点，启用后，tab 键不会将焦点移出 Popup。</td>
            <td></td>
          </tr>
          <tr>
            <td>dark</td>
            <td>boolean</td>
            <td>false</td>
            <td>是否使用 dark 主题</td>
            <td></td>
          </tr>
          <tr>
            <td>inset</td>
            <td>false</td>
            <td></td>
            <td>在锚定的布局框内部渲染 popup（默认吸附在边上，往外面渲染）。</td>
            <td></td>
          </tr>
          <tr>
            <td>open</td>
            <td>false</td>
            <td></td>
            <td>Popup 是否展示。</td>
            <td></td>
          </tr>
          <tr>
            <td>origin</td>
            <td>'center' | 'top-start' | 'top-center' | 'top-end' | 'right-start' | 'right-center' | 'right-end' | 'bottom-end' | 'bottom-center' | 'bottom-start' | 'left-end' | 'left-center' | 'left-start'</td>
            <td>'center'</td>
            <td>Popup 的原点（吸附点）。</td>
            <td></td>
          </tr>
          <tr>
            <td>restorefocus</td>
            <td>boolean</td>
            <td>false</td>
            <td>失去焦点时，是否恢复获得焦点前的焦点。</td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </section>
  </article>
</body>
</html>
